function loadScript(e,t){var n=document.createElement("script")
n.type="text/javascript",n.readyState?n.onreadystatechange=function(){"loaded"!==n.readyState&&"complete"!==n.readyState||(n.onreadystatechange=null,void 0!==t&&t())}:n.onload=function(){void 0!==t&&t()},n.src=e,document.getElementsByTagName("head")[0].appendChild(n)}var httpProto="https",readabilitySrc=httpProto+"://cdn.rawgit.com/blisszard/readability/development/Readability.min.js",jQuerySrc=httpProto+"://code.jquery.com/jquery-2.1.0.min.js",turnSrc=httpProto+"://cdn.rawgit.com/blisszard/turn.js/08c1f659/turn.min.js",loadJQquery=function(e){return"undefined"==typeof jQuery&&(loadScript(jQuerySrc,e),!0)},loadReadability=function(){loadScript(readabilitySrc,function(){var e=document.location,t={spec:e.href,host:e.host,prePath:e.protocol+"//"+e.host,scheme:e.protocol.substr(0,e.protocol.indexOf(":")),pathBase:e.protocol+"//"+e.host+e.pathname.substr(0,e.pathname.lastIndexOf("/")+1)},n=new Readability(t,document).parse()
content=n.content.replace(/<p[^>]*>/g,"").replace(/<\/p>/g,"\n"),document.head.innerHTML='<meta name="viewport" content="width=device-width" />'
var o=document.createElement("style")
o.type="text/css",o.appendChild(document.createTextNode("div#pages{white-space: pre-wrap;} body{ margin:0px; } div.page {padding:0 8px 0 8px;} #pages .turn-page{ color:#fff; background-color:#383838; background-size:100% 100%; }")),document.getElementsByTagName("head")[0].appendChild(o)
var a=!1,i=function(e){var t=e(window).height()
e(window).width()
e("#pages").turn({display:"single",acceleration:!0,gradients:!1,duration:0,height:t,width:"100%",when:{turned:function(e,t){console.log(t)}}}),e("#pages").turn("disable",!0),a=!0}
loadScript(jQuerySrc),loadScript(turnSrc,function(){jQuery(function(e){e(window).ready(function(){i(e)}),e("#pages").on("touchend click",function(t){var n=e(window).width(),o=t.pageX
if(void 0===o){if(void 0===t.originalEvent||void 0===t.originalEvent.touches[0])return
o=t.originalEvent.touches[0].pageX,t.stopPropagation(),t.preventDefault()}o<=n/2?e("#pages").turn("previous"):e("#pages").turn("next")}),e(window).bind("keydown",function(t){37==t.keyCode?e("#pages").turn("previous"):39==t.keyCode&&e("#pages").turn("next")}),e(window).resize(function(){a&&e("#pages").turn("resize")}).resize()})}),document.body.innerHTML='<div id="pages">'+jQuery(content).text()+"</div>"
!function(){jQuery(function(e){var t=e("div#pages"),n=t.text().split(" ")
!function(){var o=e('<div class="page" />')
t.empty().append(o)
for(var a=null,i=0;i<n.length;i++){var r
r=a?a+" "+n[i]:n[i],o.text(r),o.height()>e(window).height()?(o.text(a),o.clone().insertBefore(o),a=null):a=r}}()})}()})}
loadJQquery(loadReadability)||loadReadability()
