function loadScript(e,t){var n=document.createElement("script")
n.type="text/javascript",n.readyState?n.onreadystatechange=function(){"loaded"!==n.readyState&&"complete"!==n.readyState||(n.onreadystatechange=null,void 0!==t&&t())}:n.onload=function(){void 0!==t&&t()},n.src=e,document.getElementsByTagName("head")[0].appendChild(n)}var httpProto="https",readabilitySrc=httpProto+"://cdn.rawgit.com/blisszard/readability/development/Readability.min.js",jQuerySrc=httpProto+"://code.jquery.com/jquery-2.1.0.min.js",turnSrc=httpProto+"://cdn.rawgit.com/blisszard/turn.js/dev_readability/turn.min.js",loadJQquery=function(e){return"undefined"==typeof jQuery&&(loadScript(jQuerySrc,e),!0)},loadReadability=function(){loadScript(readabilitySrc,function(){var e=document.location,t={spec:e.href,host:e.host,prePath:e.protocol+"//"+e.host,scheme:e.protocol.substr(0,e.protocol.indexOf(":")),pathBase:e.protocol+"//"+e.host+e.pathname.substr(0,e.pathname.lastIndexOf("/")+1)},n=new Readability(t,document).parse()
content=n.content.replace(/<p[^>]*>/g,"").replace(/<\/?(p|br)>/g,"\n"),console.clear()
var a="<((a|img).*)>",o=content.match(new RegExp(a,"g"))
content=content.replace(new RegExp(a,"g"),"{replace}"),document.head.innerHTML='<meta charset="utf-8"><meta name="viewport" content="width=device-width" />'
var r=document.createElement("style")
r.type="text/css",r.appendChild(document.createTextNode("div#pages{white-space: pre-wrap;} body{ margin:0px; } div.page {padding:0 8px 0 8px;} #pages .turn-page{ color:#fff; background-color:#383838; background-size:100% 100%; }")),document.getElementsByTagName("head")[0].appendChild(r)
var i=!1,d=function(e){var t=e(window).height()
e("#pages").turn({display:"single",acceleration:!0,gradients:!1,duration:0,height:t,width:"100%",when:{turned:function(e,t){console.log(t)}}}),e("#pages").turn("disable",!0),i=!0}
loadScript(jQuerySrc),loadScript(turnSrc,function(){jQuery(function(e){e(window).ready(function(){d(e)}),e("#pages").on("touchend click",function(t){var n=e(window).width(),a=t.pageX
if(void 0===a){if(void 0===t.originalEvent||void 0===t.originalEvent.touches[0])return
a=t.originalEvent.touches[0].pageX,t.stopPropagation(),t.preventDefault()}a<=n/5?e("#pages").turn("previous"):e("#pages").turn("next")}),e(window).bind("keydown",function(t){37==t.keyCode?e("#pages").turn("previous"):39==t.keyCode&&e("#pages").turn("next")}),e(window).resize(function(){i&&e("#pages").turn("resize")}).resize()})}),a="{(.*?)}",document.body.innerHTML='<div id="pages">'+jQuery(content).text()+"</div>"
setTimeout(function(){jQuery(function(e){var t=e("div#pages"),n=t.text().split(/( |\n+)/)
!function(){var a=e('<div class="page" style="font-size:1.2em"/>')
t.empty().append(a)
for(var r="",i=e(window).height(),d=0,c=0,p="",l=0,s=0;s<n.length;s++){var u=n[s]
"{replace}"==u&&(u=o[l],l++),p=r+u,a.html(p),d++,d>100&&(!(c>100)||c/2<d)&&a.height()>i?(c=c>0&&c<d?c:d,d=0,a.html(r),a.clone().insertBefore(a),"{replace}"==(r=n[s])&&(l--,r=o[l],l++)):r=p}}()})}(),0)})}
loadJQquery(loadReadability)||loadReadability()
